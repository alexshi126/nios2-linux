#include <sys/ioctl.h>#include <stdio.h>#include <stdlib.h>#include <fcntl.h>#include <linux/ioctl.h>#include <errno.h>#include <unistd.h>#include <getopt.h>#include <string.h>#include <strings.h>#include <math.h>#include <math_const.h>#include <fract.h>#include <complex.h>#include <vector.h>#include <flt2fr.h>#define N		(4096)#define DC_OFFSET 	(2048)#undef HAVE_MAIN#include "FFT_Rad4_Twiddle_Factors.h"extern void FFTRad4(int *, int *, short, short *);extern void IFFTRad4(int *, int *, short, short *);extern int write_dac(unsigned short * buffer, unsigned short cnt);extern int read_adc(unsigned short * buffer, unsigned short cnt);int makeseq(unsigned short* array, int f){	int i;	/* Do some more useful math here */    	for(i = 0; i < N; i++)		array[i] = (unsigned short) (DC_OFFSET + ((DC_OFFSET - 1) * sin(f * 2 * PI * i / N)));             	return 0;}int sample_and_calc(int *buffer, int cnt, char *outfile){	int i, ret;	unsigned short *samples;	FILE *fd;		samples = malloc(N * sizeof(unsigned short));	if (samples == NULL) {		return -ENOMEM;	}	makeseq(samples, 64);	ret = write_dac(samples, N);	if (ret) 		return ret;	if (outfile != NULL) {		fd = fopen (outfile, "w");		fprintf (fd, "# DACOUT Sequence 0..4095\n");	        for(i=0; i<N; i++) {			fprintf (fd, "%d,\n", samples[i]);			}			}	ret = read_adc(samples, N);	if (ret) {		fclose(fd);		return ret;	}	if (outfile != NULL) {		fprintf (fd, "\n\n# ADCIN Sequence 0..4095\n");	        for(i=0; i<N; i++) {			fprintf (fd, "%d,\n", samples[i]);			}				fclose(fd);	}	/* Do some more useful math here */	for(i=0; i<cnt; i++)		buffer[i] = samples[i];	free(samples);	return 0;}